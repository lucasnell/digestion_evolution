% compute derivatives of the likelihood function to obtain% asymptotic estimates of the se of the estimators % (see Judge et al. 1985, Chapter 5)function [SE, corrSE]=MERegApproxSEfunct(sol,n,p,Dx)dx=Dx*abs(sol);npar=p;Q=zeros(npar,npar);for i=1:npar,	solw=sol;	solw(i)=sol(i)+dx(i);	Q(i,i)=2*(MERegMLfunct(solw)-MERegMLfunct(sol))/dx(i)^2;end	for i=1:npar,for j=i+1:npar,	solw=sol;	solw(i)=sol(i)+dx(i);	solw(j)=sol(j)+dx(j);	Q(i,j)=(MERegMLfunct(solw)-MERegMLfunct(sol))/(dx(i)*dx(j)) - ...		.5*(Q(i,i)*dx(i)/dx(j)+Q(j,j)*dx(j)/dx(i));endendQtest=Q+triu(Q,1)';Dxweight=1./diag(Qtest);Dxweight=Dxweight./mean(Dxweight);%%%%%% compute with positive weighted with dxdx=Dx*Dxweight;Q=zeros(npar,npar);for i=1:npar,	solw=sol;	solw(i)=sol(i)+dx(i);	Q(i,i)=2*(MERegMLfunct(solw)-MERegMLfunct(sol))/dx(i)^2;end	for i=1:npar,for j=i+1:npar,	solw=sol;	solw(i)=sol(i)+dx(i);	solw(j)=sol(j)+dx(j);	Q(i,j)=(MERegMLfunct(solw)-MERegMLfunct(sol))/(dx(i)*dx(j)) - ...		.5*(Q(i,i)*dx(i)/dx(j)+Q(j,j)*dx(j)/dx(i));endendQ1=Q+triu(Q,1)';%%%%%% repeat with negative dxdx=-Dx*Dxweight;Q=zeros(npar,npar);for i=1:npar,	solw=sol;	solw(i)=sol(i)+dx(i);	Q(i,i)=2*(MERegMLfunct(solw)-MERegMLfunct(sol))/dx(i)^2;end	for i=1:npar,for j=i+1:npar,	solw=sol;	solw(i)=sol(i)+dx(i);	solw(j)=sol(j)+dx(j);	Q(i,j)=(MERegMLfunct(solw)-MERegMLfunct(sol))/(dx(i)*dx(j)) - ...		.5*(Q(i,i)*dx(i)/dx(j)+Q(j,j)*dx(j)/dx(i));endendQ2=Q+triu(Q,1)';% approximate root mean sum of squares used to obtain significance values% from a Chi-square distributionQ=(Q1+Q2)/2;SE=(1/n^.5)*diag((Q./n)^(-1)).^.5;covSE=(1/n)*(Q./n)^(-1);corrSE=covSE./((SE*ones(1,npar)).*(ones(npar,1)*SE'));